var $jscomp={scope:{},getGlobal:function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global?global:f}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(f){return"jscomp_symbol_"+f+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
$jscomp.makeIterator=function(f){$jscomp.initSymbolIterator();if(f[$jscomp.global.Symbol.iterator])return f[$jscomp.global.Symbol.iterator]();if(!(f instanceof Array||"string"==typeof f||f instanceof String))throw new TypeError(f+" is not iterable");var l=0;return{next:function(){return l==f.length?{done:!0}:{done:!1,value:f[l++]}}}};$jscomp.arrayFromIterator=function(f){for(var l,h=[];!(l=f.next()).done;)h.push(l.value);return h};
$jscomp.arrayFromIterable=function(f){return f instanceof Array?f:$jscomp.arrayFromIterator($jscomp.makeIterator(f))};$jscomp.arrayFromArguments=function(f){for(var l=[],h=0;h<f.length;h++)l.push(f[h]);return l};
$jscomp.inherits=function(f,l){function h(){}h.prototype=l.prototype;f.prototype=new h;f.prototype.constructor=f;for(var t in l)if($jscomp.global.Object.defineProperties){var p=$jscomp.global.Object.getOwnPropertyDescriptor(l,t);void 0!==p&&$jscomp.global.Object.defineProperty(f,t,p)}else f[t]=l[t]};var $jscomp$templatelit$13=["list-group"];$jscomp$templatelit$13.raw=["list-group"];var $jscomp$templatelit$12=["col-md-3"];$jscomp$templatelit$12.raw=["col-md-3"];var $jscomp$templatelit$11=["col-md-9"];
$jscomp$templatelit$11.raw=["col-md-9"];var $jscomp$templatelit$10=["row"];$jscomp$templatelit$10.raw=["row"];var $jscomp$templatelit$9=["text-right"];$jscomp$templatelit$9.raw=["text-right"];var $jscomp$templatelit$8=["text-right"];$jscomp$templatelit$8.raw=["text-right"];var $jscomp$templatelit$7=["text-right"];$jscomp$templatelit$7.raw=["text-right"];var $jscomp$templatelit$6=["text-right"];$jscomp$templatelit$6.raw=["text-right"];var $jscomp$templatelit$5=["table"];$jscomp$templatelit$5.raw=["table"];
(function(){function f(a,b,c){"string"===typeof a&&(a=document.createElement(a));"function"===typeof c&&(c=c(a));if("string"===typeof c||"number"===typeof c)a.insertBefore(document.createTextNode(c),b);else if(Array.isArray(c)){c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())f(a,b,d.value)}else if(c)if(c.nodeType)a.insertBefore(c,b);else if(c.$insert)c.$insert(a,b);else for(d in c)(b=c[d])&&b.$prop?b.$prop(a,d,l.bind(null,a,d)):l(a,d,b);return a}function l(a,b,c){void 0!==c&&("$"===
b.charAt(0)?a.style[b.substring(1)]=c:a[b]!==c&&(b in a||console.warn("unknown property ",b," in ",a),a[b]=c))}function h(a){var b={},c,d=function(d){b!==d&&(c=a(b=d));return c};d.org=a;return d}function t(a,b){if(a!==b){if("object"!==typeof b||Array.isArray(b)||"object"!==typeof a||Array.isArray(a))return b;var c,d;for(d in b){var e=t(a[d],b[d]);void 0!==e&&(c||(c={}),c[d]=e)}return c}}function p(a,b){if(void 0===b||a===b)return a;if("object"!==typeof b||Array.isArray(b)||"object"!==typeof a||Array.isArray(a))return b;
var c=void 0,d;for(d in b)c||(c=Object.assign({},a)),c[d]=p(c[d],b[d]);return c||a}function D(a){var b=function(b,d){try{return eval("(function() {"+a.substring(0,b)+d+a.substring(b+1)+"})")}catch(e){}};if(!b(0,a.charAt(0)))return[e.p(e.i("This level does not work in your browser.")),a];a=""+a;return a.split("").map(function(a,d){return b(d,"#")?e.span({$color:"#600"},a):b(d,"$")?a:e.b(a)})}function A(){try{return btoa(String.fromCharCode.apply(0,crypto.getRandomValues(new Uint8Array(15))))}catch(a){return""+
Math.random()+Math.random()}}function B(a){for(var b="other",c=$jscomp.makeIterator([/\w*Safari\/\d+/,/Chrome\/\d+/,/Firefox\/\d+/,/Edge\/\d+/]),d=c.next();!d.done;d=c.next())(d=d.value.exec(a))&&(b=d[1]||d[0]);/Mobile/.test(a)&&(b="Mob");return e.div({$color:"#999",title:a},b)}var e,g;e=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];return f(a,null,c)};var C=function(a,b){var c=0,d;return function(){d||(d=setTimeout(function(){c=Date.now();d=0;b()},Math.max(c+a-Date.now(),
0)))}};g=function(a){return{__proto__:g.ops,get:function(){return a},change:function(b){return a!==(a=b(a))&&g.refresh()}}};var z=new Map;g.inverse=function(a,b){z.set(a,b);z.set(b,a)};g.inverse(JSON.stringify,JSON.parse);g.all=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return{__proto__:g.ops,get:function(){return b.map(function(a){return a.get()})},change:function(a){throw"exercise for the reader";}}};g.ops={map:function(a,b){var c=this;b=b||z.get(a);return{__proto__:g.ops,
get:function(){return a(c.get())},change:function(d){return c.change(function(c){return b(d(a(c)),c)})}}},use:function(a){return this.map(h(a))},sub:function(a){return this.map(function(b){return b&&b[a]},function(b,c){var d={};return Object.assign({},c,(d[a]=b,d))})},index:function(a){var b=this;return{__proto__:g.ops,get:function(){return b.sub(a.get()).get()},change:function(c){return b.sub(a.get()).change(c)}}},$insert:function(a,b){var c=this,d=document.createComment("\ud83d\udccc"),e=document.createComment("\ud83c\udf8f");
f(a,b,d);f(a,b,e);var g=h(function(b){for(;d.nextSibling&&d.nextSibling!==e;)d.parentNode.removeChild(d.nextSibling);f(a,e,b)});d.$ping=function(){return g(c.get())};d.$ping()},$prop:function(a,b,c){var d=this,e=h(function(a){return c(a)});a.$props=a.$props||{};b=a.$props[b]=function(){return e(d.gets())};a.$ping=function(){for(var a in this.$props)this.$props[a]()};b()},gets:function(){var a=this.get();return a&&a.$prop?a.gets():a},deepEq:function(){return this.use(function(a){return a&&JSON.stringify(a)}).use(function(a){return a&&
JSON.parse(a)})}};g.refresh=C(100,function(){function a(b){for(;b;)b.$ping&&b.$ping(),a(b.firstChild),b=b.nextSibling}a(document.documentElement)});"a abbr address area article aside audio b base bdi bdo blockquote body br button canvas caption cite code col colgroup command datalist dd del details dfn div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link map mark marquee menu meta meter nav noscript object ol optgroup option output p param pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td textarea tfoot th thead time title tr track u ul var video wbr".split(" ").forEach(function(a){return e[a]=
function(b){for(var c=[],d=0;d<arguments.length;++d)c[d-0]=arguments[d];return e(a,c)}});Object.assign(g.ops,{set:function(a){this.change(function(){return a})},takeFrom:function(a){var b=this;return function(){b.set(this[a])}},bindProp:function(a,b){a=void 0===a?"value":a;var c={};return c[a]=this,c[void 0===b?"oninput":b]=this.takeFrom(a),c},spread:function(a){var b=this;return this.use(function(a){return a&&JSON.stringify(Object.keys(a))}).use(function(a){return a&&JSON.parse(a)}).use(function(c){return c&&
c.map(function(c){return a(b.sub(c),c)})})},ifthen:function(a,b){return this.use(function(a){return!!a}).use(function(c){return c?a():b&&b()})}});g.promise=function(a){var b=g();a(function(a){return b.set(a)});return b};g.localStorage=function(a){window.onstorage=function(){return g.refresh()};return{__proto__:g.ops,get:function(){return localStorage[a]},change:function(b){localStorage[a]=b(localStorage[a]);g.refresh()}}};g.remote=function(a){var b=g("init"),c={},d={},e={},f={},l={},n={},x={},h=0,
y=C(500,function(){var g=[],w=[],k;for(k in d)k in e||n[k]&&n[k]>Date.now()-1E4&&!(h>Date.now()-1E4)||(g.push(l[k]),n[k]=Date.now());for(k in f)void 0!==f[k]&&(x[k]&&x[k]>Date.now()-1E4||w.push([l[k],f[k]]));if(0!=g.length+w.length){var v=1E3;fetch(a,{method:"POST",body:JSON.stringify([g,w])}).then(function(a){return a.json()}).then(function(a){"object"!==typeof a?(console.warn(a),h=Date.now(),setTimeout(y,v*=2)):a.forEach(function(a){var b=a[0][0],e=a[1];b in c?c[b].received(e):console.error("Key?",
a)})})["catch"](function(a){console.log(a);h=Date.now();setTimeout(y,v*=2)});b.set(g.length?"...":"ok")}});return{find:function(a){for(var b=[],k=0;k<arguments.length;++k)b[k-0]=arguments[k];for(var n=function(){d[m]=Date.now();y();return p(e[m],f[m])},k=$jscomp.makeIterator(b),h=k.next();!h.done;h=k.next()){h=h.value;if(void 0===h)return g();if(h&&"object"==typeof h)for(var m in h)if(void 0===h[m])return g()}m=JSON.stringify(b);if(k=c[m])return k;l[m]=[].concat([m],$jscomp.arrayFromIterable(b));
d[m]=Date.now();var E=[];return k=c[m]={__proto__:g.ops,get:n,change:function(a){if(m in e){var b=n();f[m]=x[m]=t(e[m],a(b));y();g.refresh()}else E.push(function(){return c[m].change(a)})},received:function(a){e[m]=p(e[m],a);f[m]=x[m]=t(a,f[m]);g.refresh()},$$key:m}},status:b}};var r=function(a){return{className:a}};g.ops.ifthen=function(a,b){return this.use(function(a){return!!a}).use(function(c){return c?a():b&&b()})};var F="data:text/html,<script>!"+escape(function(){window.onmessage=function(a){window.onmessage=
null;var b=Object.create(null),c=top.postMessage.bind(top,b,"*");b.token=a.data.token;var e=eval("(function(){"+a.data.task+"; return "+a.data.fname+";})()"),f=a.data.fname,e=e.apply.bind(e,null),g=0;window[f]=e;window[f+"_wrapper"]=function(){if(g++)throw"Don't.";var a;try{a=e(arguments),!0===a&&(b["true"]=!0),b.text=""+a}catch(f){try{f=""+f}catch(h){f="Well, sure."}b.bad=1;b.text=f}c()};try{f=function(a){(a||h)()};window.verifyInput&&window.verifyInput(a.data.input);var h=Function(a.data.fname+
"_wrapper("+a.data.input+")");f(f)}catch(n){try{b.text=""+n}catch(l){b.text="Heh."}b.bad=1;c()}}})+"()\x3c/script>";e(root,function(){function a(a,b){function c(){var b=l.find("hof",{game:a},["uid"]),d="";return e.table(r($jscomp$templatelit$5),e.thead(e.tr(e.th("#"),e.th("Name"),e.th(r($jscomp$templatelit$6),"Levels"),e.th(r($jscomp$templatelit$7),"Total strokes"))),e.tbody(b.use(function(a){return a&&Object.keys(a).map(function(b){return a[b]}).filter(function(a){return"moof"!=a.name}).sort(function(a,
b){return b.levels-a.levels||a.points-b.points}).map(function(a,b){var c=d;d=a.levels+"/"+a.points;return e.tr(e.td(c===d?"":b+1),e.td(a.name),e.td(r($jscomp$templatelit$8),a.levels),e.td(r($jscomp$templatelit$9),a.points))})})))}function f(a){function c(d,f){var g=/^\w+$/.test(a)&&"random4"!==a,h=l.find("user",["uid"]),k=h.sub(b);w.sub(a);var k=k.sub("name"),q=l.find("entry",{lid:a},["uid"]),k=d&&!0&&[e.tr(e.td(e.input({className:"input",size:20,$marginRight:"1em",placeholder:"Your name"},k.bindProp("value",
"onchange")),k.ifthen(function(){return e.input({className:"input",size:40,placeholder:"Comment"},q.sub(b).sub("comment").bindProp("value","onchange"))})),e.td({$textAlign:"right"},d),e.td(B(navigator.userAgent)))],n=function(a){return q.use(function(c){return Object.keys(c||{}).map(function(a){return c[a]}).filter(function(c){return a(c.score)&&(c.uid!==b||g)}).sort(function(a,b){return a.score-b.score||a.rowid-b.rowid}).map(function(a){return h.sub(a.uid).sub("name").use(function(b){return b&&e.tr(e.td({$maxWidth:"300px",
$overflowWrap:"break-word"},e.b(b)," \u00a0 ",a.comment,a.star?e.i(" \u2013 ",a.star):null),e.td({$textAlign:"right"},f?a.code:a.score),e.td(B(a.agent)))})})})};return e("div",e.style(".comments td { padding-left:10px }"),g&&e.p("This score board is closed; if you have an even shorter solution, send it to @steike. \u00a0 ",!1),e.div({$maxHeight:"1000px",$overflow:"scroll"},e.table({className:"table table-condensed table-striped"},e.thead(e.tr(["User",f?"Solution":"Score","Browser"].map(function(a){return e.th(a)}))),
e.tbody(g?n(function(a){return 42}):[n(function(a){return a<d}),k,n(function(a){return a>=d})]))))}var n=w.sub(a),q=d.sub("scratch").sub(a),u=v.sub(a).sub("code"),p=g(),r=function(b,c,e,d){return function(c){var f=[]+[Math.random(),Math.random(),Math.random()];window.onmessage=function(c){c.data.token===f&&(p.set((c.data.bad?"\u2716 ":"\u25b7 ")+c.data.text),c.data.bad&&b&&u.get()===b&&u.set(b+" /* did not work this time? */"),c.data["true"]&&(!u.get()||u.get().length>b.length)&&(v.sub(a).sub("agent").set(navigator.userAgent),
u.set(b)))};this.contentWindow.postMessage({input:b,fname:e,task:d,token:f},"*")}};return n.ifthen(function(){return[e.pre({className:"well"},!1,n.sub("code").use(D),"\n\n\u25b6 ",n.sub("name"),"(",e.input({$insert:function(a){return setTimeout(function(){return a.focus()},2)}},{autofocus:!0,id:"input",className:"sneak",value:q,oninput:q.takeFrom("value"),placeholder:u,size:q.use(function(a){return("x"+(a||u.get())).length||3}),onkeypress:function(b){13===b.keyCode&&u.get()===q.get()&&u.get()&&(b=
k.get(),h.set(b[b.indexOf(a)+1]))}}),")",e.span({$color:"#999"},q.use(function(a){return a?"  // ("+a.length+" chars)":""})),"\n",p),u.use(function(a){return a&&t.use(function(b){return c(a.length,b)})}),n.use(function(a){return a&&a.code&&q.use(function(b){return e.iframe({sandbox:"allow-scripts",$border:"none",$width:"100%",$height:30,src:F,onload:r(b,a.lid,a.name,a.code)})})})]})}function q(a,b,c){return e.li({className:h.use(function(b){return a==b?"active list-group-item":"list-group-item"}),
$paddingTop:"4px",$paddingBottom:"4px",onclick:function(){h.set(a)}},b,c&&c.use(function(a){return"string"===typeof a&&" ("+a.length+")"}))}var w=l.find("level",{game:a},["lid"]),k=w.use(function(a){return a&&Object.keys(a).map(function(b){return[a[b].rank,b]}).sort().map(function(a){return a[1]})}),v=l.find("entry",{uid:b},["lid"]);h.get()||h.set("id");var p=g.all(k,v).use(function(a){var b=$jscomp.makeIterator(a);a=b.next().value;b=b.next().value;if(!a)return 0;if(localStorage.showall)return a.length;
for(var c=1,e=0,d=0;d<a.length;d++)if(b&&b[a[d]]&&b[a[d]].code)c++;else if(++e>c)return d;return a.length});return{ui:e.div(r($jscomp$templatelit$10),e("style","\n.sneak {\n  font-family:inherit; font-size:inherit;\n}\n.lift {\n        margin:-2px;\n    }\ninput.sneak:focus {\n    outline:none;\n    border-color:transparent;\n    background:none;\n}\ndiv.radio {\n    border: 1px solid #ccc;\n    display: inline-block;\n    text-decoration: none;\n    color: black;\n    padding: 10px;\n    margin-right:4px;\n    border-radius: 20px;\n    width: 40px;\n    height: 40px;\n    text-align: center;\n}\ndiv.radio.on {\n    background:#f8f8f8;\n    border:1px solid #666;\n}"),
e.div(r($jscomp$templatelit$11),h.use(function(a){return"_"===a?c():f(a)})),e.div(r($jscomp$templatelit$12),e.nav(e.ul(r($jscomp$templatelit$13),p.use(function(a){return k.use(function(b){return b&&b.slice(0,a).map(function(a){return q(a,w.sub(a).sub("name"),v.sub(a).sub("code"))})})}))))),canSee:p}}var b;try{var c=/accesstoken=(.+)/.exec(location.hash)[1].substring(0,20);if(15===atob(c).length||localStorage.showall)b=c}catch(f){}b=b||(localStorage.token=localStorage.token||A());var d=g.localStorage("true").map(function(a){return a&&
JSON.parse(a)},JSON.stringify),h=d.sub("current"),l=g.remote((localStorage.serverUrl||"http://bigger.alf.nu/db/true/")+b),c=l.find("meta").sub("uid"),t=g(!1);return c.use(function(c){var d=a("true",c),f="http://alf.nu/ReturnTrue#accesstoken="+b;window.jump=function(a){h.set(a);a=a.split("-");a[1]&&p.set(a[0])};var p=g("true");return[e.h1({$marginBottom:".7em"},"return true to win"),p.use(function(b){return"true"===b?d.ui:a(b,c).ui}),d.canSee.use(function(a){return 3<a&&e.p("To save your game (or move to a different browser), bookmark ",
e.a({href:f},"this link."))}),d.canSee.use(function(a){if(10<a){a=l.find("level",{game:c},["lid"]);var b=g(),d=a.index(b);return[e.ul({className:"nav nav-tabs"},a.spread(function(a,c){return[e.li({className:b.use(function(a){return a===c?"active":""})},e.a({onclick:function(){return b.set(c)}},a.sub("name").use(function(a){return JSON.stringify(a)})))]}),e.li(e.a({onclick:function(){b.set(c+"-"+A().substring(0,8));d.set({name:"untitled",code:"function untitled(x) {\n    return false;\n}"})}},"New level"))),
b.ifthen(function(){return e.div({className:"well"},[e.textarea({$fontFamily:"menlo,monospace",rows:8,cols:70},d.sub("code").bindProp()),e.p("Function to call ",e.input(d.sub("name").bindProp())," ... ",e.input({type:"submit",value:"Test it!",onclick:function(){p.set(c);h.set(b.get())}}))])})]}})]})}())})();
